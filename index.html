<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>history map</title>
    <link href="css/style.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <script src="javascript/jquery-3.7.1.min.js"></script>
    <script src="javascript/d3.v5.min.js"></script>
</head>

<body>
<nav class="navbar navbar-default navbar-fixed-top">

</nav>

<svg id="map" style="width:200vw; height:200vh;" >
</svg>

<div class="timeline">
    <ul>
        <li id="1900">1900</li>
        <li id="1945">1945</li>
        <li id="2000">2000</li>
    </ul>
</div>
</body>

<script>
    var height=parseFloat($("svg").css("height"))
    var width=parseFloat($("svg").css("width"))
    //创建一个地图投影
    var projection = d3.geoNaturalEarth1()
        .scale(600)
        .translate([width/2,height/2])

    //创建一个地理路径生成器
    var geoPath = d3.geoPath()
        .projection(projection)//设置地理路径生成器的投影方式


    var svg=d3.select('#map').selectAll('path')
    function update(geojson){
        projection.fitSize([0.8*width,0.8*height],geojson)
    }
    function drawmap(data) {
        console.log(data);
        //update(data);

         var color = d3.scaleOrdinal()
            .domain(d3.range(data.features.length))
            .range(d3.schemePastel2);

            svg.remove();
            svg.data(data.features).enter()
            .append('path')
            .attr('d', geoPath)
            .attr('stroke','gray')
            .attr('stroke-width',1)
            .attr('fill', function (d, i) {
                return color(i);
            })
            .on('mouseover', function () {
                d3.select(this).attr('fill', 'green');
            })
            .on('mouseout', function (d,i) {
                d3.select(this).attr('fill', color(i));
            })


        }

    function get2000() {
        d3.json('geojson/world_2000.geojson').then(drawmap)
    }
    function get1945() {
        d3.json('geojson/world_1945.geojson').then(drawmap)
    }
    function get1900() {
        d3.json('geojson/world_1900.geojson').then(drawmap)
    }
    get2000()
    $("#2000").click(get2000)
    $('#1945').click(get1945)
    $('#1900').click(get1900)

        //新建一个颜色比例尺
       /* var scaleColor = d3.scaleOrdinal()
            .domain(d3.range(data.features.length))
            .range(d3.schemeCategory10);




        //绘制文字
        g.append('g')
            .selectAll('text')
            .data(data.features)
            .enter()
            .append('text')
            .attr('font-size',12)
            .attr('text-anchor', 'middle')
            .attr('x',function (d,i) {
                var position = mercator(d.properties.centroid || [0,0]);
                return position[0];
            })
            .attr('y',function (d,i) {
                var position = mercator(d.properties.centroid || [0,0]);
                return position[1];
            })
            .attr('dy',function (d,i) {
                //这里为什么这么写呢，因为澳门和香港重合了，挤到一起了。
                if (d.properties.name === '澳门特别行政区') {
                    return 10;
                }
            })
            .text(function (d,i) {
               return d.properties.name;
            });

    });*/

</script>
<script src="javascript/bootstrap.min.js"></script>
</html>